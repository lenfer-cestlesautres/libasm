section .text
    global ft_write
    extern __errno_location

ft_write:
    mov     rax, 1        ; syscall: write
    syscall               ; –≤—ã–∑–æ–≤ —è–¥—Ä–∞: write(fd, buf, count)
    cmp     rax, 0
    jl      .error        ; –µ—Å–ª–∏ rax < 0 ‚Üí –æ—à–∏–±–∫–∞
    ret

.error:
    neg     rax           ; rax = -rax (—Ç–µ–ø–µ—Ä—å –≤ rax –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–π errno)
    mov     rdi, rax      ; –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–π –∫–æ–¥ –æ—à–∏–±–∫–∏ ‚Üí rdi
    call    __errno_location
    mov     [rax], rdi    ; *errno = –∫–æ–¥ –æ—à–∏–±–∫–∏
    mov     rax, -1       ; –≤–µ—Ä–Ω—É—Ç—å -1
    ret

section .note.GNU-stack noalloc noexec nowrite progbits




;–í ft_write —Ç—ã –Ω–µ –≤—ã–∑—ã–≤–∞–µ—à—å –¥—Ä—É–≥—É—é —Ñ—É–Ω–∫—Ü–∏—é, —Ç—ã –¥–µ–ª–∞–µ—à—å –ø—Ä—è–º–æ–π –≤—ã–∑–æ–≤ —è–¥—Ä–∞ Linux —á–µ—Ä–µ–∑ syscall.
;üß† –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å–∏—Å—Ç–µ–º–Ω—ã–π –≤—ã–∑–æ–≤ (x86_64 Linux)
;–†–µ–≥–∏—Å—Ç—Ä	–ó–Ω–∞—á–µ–Ω–∏–µ
;rax	–Ω–æ–º–µ—Ä —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞
;rdi	1-–π –∞—Ä–≥—É–º–µ–Ω—Ç (fd)
;rsi	2-–π –∞—Ä–≥—É–º–µ–Ω—Ç (buf)
;rdx	3-–π –∞—Ä–≥—É–º–µ–Ω—Ç (count)
;–î–ª—è write, —Å–∏—Å—Ç–µ–º–Ω—ã–π –≤—ã–∑–æ–≤ –∏–º–µ–µ—Ç –Ω–æ–º–µ—Ä 1.
;
; –ü–æ—á–µ–º—É –Ω—É–∂–µ–Ω __errno_location
;
;    errno ‚Äî –≥–ª–æ–±–∞–ª—å–Ω–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è, –Ω–æ –≤ –º–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω—ã—Ö –ø—Ä–æ–≥—Ä–∞–º–º–∞—Ö —É –∫–∞–∂–¥–æ–≥–æ –ø–æ—Ç–æ–∫–∞ ‚Äî —Å–≤–æ—è.
;
;    __errno_location –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —É–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ —Ç–µ–∫—É—â–∏–π errno, —Å –∫–æ—Ç–æ—Ä—ã–º –º–æ–∂–Ω–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å.